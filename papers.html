<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Publications – STRATOS TG2: Selection of variables and functional forms for multivariable models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-747c247e971958b7073b511b116382cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./papers.html">Publications</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./assets/stratos-color-transpbackgr.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/stratostg2/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./members.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Members</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./papers.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Publications</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./activities.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Activities</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glossary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About this website</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#topic-group-2-tg2-publications" id="toc-topic-group-2-tg2-publications" class="nav-link active" data-scroll-target="#topic-group-2-tg2-publications">Topic Group 2 (TG2) Publications</a>
  <ul class="collapse">
  <li><a href="#a-systematic-categorization-of-performance-measures-for-estimated-non-linear-associations-between-an-outcome-and-continuous-predictors" id="toc-a-systematic-categorization-of-performance-measures-for-estimated-non-linear-associations-between-an-outcome-and-continuous-predictors" class="nav-link" data-scroll-target="#a-systematic-categorization-of-performance-measures-for-estimated-non-linear-associations-between-an-outcome-and-continuous-predictors">A Systematic Categorization of Performance Measures for Estimated Non-Linear Associations Between an Outcome and Continuous Predictors</a>
  <ul class="collapse">
  <li><a href="#abstract" id="toc-abstract" class="nav-link" data-scroll-target="#abstract">Abstract</a></li>
  </ul></li>
  <li><a href="#evaluating-variable-selection-methods-for-multivariable-regression-models-a-simulation-study-protocol" id="toc-evaluating-variable-selection-methods-for-multivariable-regression-models-a-simulation-study-protocol" class="nav-link" data-scroll-target="#evaluating-variable-selection-methods-for-multivariable-regression-models-a-simulation-study-protocol">Evaluating variable selection methods for multivariable regression models: A simulation study protocol</a>
  <ul class="collapse">
  <li><a href="#abstract-1" id="toc-abstract-1" class="nav-link" data-scroll-target="#abstract-1">Abstract</a></li>
  </ul></li>
  <li><a href="#regression-without-regrets-initial-data-analysis-is-a-prerequisite-for-multivariable-regression" id="toc-regression-without-regrets-initial-data-analysis-is-a-prerequisite-for-multivariable-regression" class="nav-link" data-scroll-target="#regression-without-regrets-initial-data-analysis-is-a-prerequisite-for-multivariable-regression">Regression without regrets –initial data analysis is a prerequisite for multivariable regression</a>
  <ul class="collapse">
  <li><a href="#abstract-2" id="toc-abstract-2" class="nav-link" data-scroll-target="#abstract-2">Abstract</a></li>
  </ul></li>
  <li><a href="#review-of-guidance-papers-on-regression-modeling-in-statistical-series-of-medical-journals" id="toc-review-of-guidance-papers-on-regression-modeling-in-statistical-series-of-medical-journals" class="nav-link" data-scroll-target="#review-of-guidance-papers-on-regression-modeling-in-statistical-series-of-medical-journals">Review of guidance papers on regression modeling in statistical series of medical journals</a>
  <ul class="collapse">
  <li><a href="#abstract-3" id="toc-abstract-3" class="nav-link" data-scroll-target="#abstract-3">Abstract</a></li>
  </ul></li>
  <li><a href="#systematic-review-of-education-and-practical-guidance-on-regression-modeling-for-medical-researchers-who-lack-a-strong-statistical-background-study-protocol" id="toc-systematic-review-of-education-and-practical-guidance-on-regression-modeling-for-medical-researchers-who-lack-a-strong-statistical-background-study-protocol" class="nav-link" data-scroll-target="#systematic-review-of-education-and-practical-guidance-on-regression-modeling-for-medical-researchers-who-lack-a-strong-statistical-background-study-protocol">Systematic review of education and practical guidance on regression modeling for medical researchers who lack a strong statistical background: Study protocol</a></li>
  <li><a href="#state-of-the-art-in-selection-of-variables-and-functional-forms-in-multivariable-analysisoutstanding-issues" id="toc-state-of-the-art-in-selection-of-variables-and-functional-forms-in-multivariable-analysisoutstanding-issues" class="nav-link" data-scroll-target="#state-of-the-art-in-selection-of-variables-and-functional-forms-in-multivariable-analysisoutstanding-issues">State of the art in selection of variables and functional forms in multivariable analysis—outstanding issues</a>
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">Background</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  </ul></li>
  <li><a href="#a-review-of-spline-function-procedures-in-r" id="toc-a-review-of-spline-function-procedures-in-r" class="nav-link" data-scroll-target="#a-review-of-spline-function-procedures-in-r">A review of spline function procedures in R</a>
  <ul class="collapse">
  <li><a href="#background-1" id="toc-background-1" class="nav-link" data-scroll-target="#background-1">Background</a></li>
  <li><a href="#methods-1" id="toc-methods-1" class="nav-link" data-scroll-target="#methods-1">Methods</a></li>
  <li><a href="#results-1" id="toc-results-1" class="nav-link" data-scroll-target="#results-1">Results</a></li>
  <li><a href="#conclusions-1" id="toc-conclusions-1" class="nav-link" data-scroll-target="#conclusions-1">Conclusions</a></li>
  </ul></li>
  <li><a href="#recent-activities-of-the-topic-group-on-selection-of-variables-and-functional-forms-in-multivariable-analysis-tg2" id="toc-recent-activities-of-the-topic-group-on-selection-of-variables-and-functional-forms-in-multivariable-analysis-tg2" class="nav-link" data-scroll-target="#recent-activities-of-the-topic-group-on-selection-of-variables-and-functional-forms-in-multivariable-analysis-tg2">Recent activities of the Topic Group on Selection of Variables and Functional Forms in Multivariable Analysis (TG2)</a></li>
  <li><a href="#introducing-the-topic-group-on-selection-of-variables-and-functional-forms-in-multivariable-analysis-tg2" id="toc-introducing-the-topic-group-on-selection-of-variables-and-functional-forms-in-multivariable-analysis-tg2" class="nav-link" data-scroll-target="#introducing-the-topic-group-on-selection-of-variables-and-functional-forms-in-multivariable-analysis-tg2">Introducing the Topic Group on Selection of Variables and Functional Forms in Multivariable Analysis (TG2)</a></li>
  </ul></li>
  <li><a href="#further-suggested-publications" id="toc-further-suggested-publications" class="nav-link" data-scroll-target="#further-suggested-publications">Further Suggested Publications</a>
  <ul class="collapse">
  <li><a href="#books" id="toc-books" class="nav-link" data-scroll-target="#books">Books</a></li>
  <li><a href="#papers" id="toc-papers" class="nav-link" data-scroll-target="#papers">Papers</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Publications</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="topic-group-2-tg2-publications" class="level1">
<h1>Topic Group 2 (TG2) Publications</h1>
<p>These publications were written on behalf of STRATOS-TG2. They center around the topic group’s core topic, the selection of variables and functional forms in multivariable models.</p>
<section id="a-systematic-categorization-of-performance-measures-for-estimated-non-linear-associations-between-an-outcome-and-continuous-predictors" class="level2">
<h2 class="anchored" data-anchor-id="a-systematic-categorization-of-performance-measures-for-estimated-non-linear-associations-between-an-outcome-and-continuous-predictors">A Systematic Categorization of Performance Measures for Estimated Non-Linear Associations Between an Outcome and Continuous Predictors</h2>
<p>Ullmann T, Heinze G, Abrahamowicz M, Perperoglou A, Sauerbrei W, Schmid M, Dunkler D, for TG2 of the STRATOS initiative, 2025. A Systematic Categorization of Performance Measures for Estimated Non-Linear Associations Between an Outcome and Continuous Predictors. WIREs Computational Statistics 17(3), e70042. <a href="https://doi.org/10.1002/wics.70042">https://doi.org/10.1002/wics.70042</a></p>
<details>
<summary>
Abstract
</summary>
<section id="abstract" class="level3">
<h3 class="anchored" data-anchor-id="abstract">Abstract</h3>
<p>In regression analysis, associations between continuous predictors and the outcome are often assumed to be linear. However, modeling the associations as non-linear can improve model fit. Many flexible modeling techniques, like (fractional) polynomials and spline-based approaches, are available. Such methods can be systematically compared in simulation studies, which require suitable performance measures to evaluate the accuracy of the estimated curves against the true data-generating functions. Although various measures have been proposed in the literature, no systematic overview exists so far. To fill this gap, we introduce a categorization of performance measures for evaluating estimated non-linear associations between an outcome and continuous predictors. This categorization includes many commonly used measures. The measures can not only be used in simulation studies, but also in application studies to compare different estimates to each other. We further illustrate and compare the behavior of different performance measures through some examples and a Shiny app.</p>
</section></details>
</section>
</section>
<section id="evaluating-variable-selection-methods-for-multivariable-regression-models-a-simulation-study-protocol" class="level2">
<h2 class="anchored" data-anchor-id="evaluating-variable-selection-methods-for-multivariable-regression-models-a-simulation-study-protocol">Evaluating variable selection methods for multivariable regression models: A simulation study protocol</h2>
<p>Ullmann, T., Heinze, G., Hafermann, L., Schilhart-Wallisch, C., Dunkler, D., for TG2 of the STRATOS initiative, 2024. Evaluating variable selection methods for multivariable regression models: A simulation study protocol. PLoS ONE 19, e0308543. <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0308543">https://doi.org/10.1371/journal.pone.0308543</a></p>
<details>
<summary>
Abstract
</summary>
<section id="abstract-1" class="level3">
<h3 class="anchored" data-anchor-id="abstract-1">Abstract</h3>
<p>Researchers often perform data-driven variable selection when modeling the associations between an outcome and multiple independent variables in regression analysis. Variable selection may improve the interpretability, parsimony and/or predictive accuracy of a model. Yet variable selection can also have negative consequences, such as false exclusion of important variables or inclusion of noise variables, biased estimation of regression coefficients, underestimated standard errors and invalid confidence intervals, as well as model instability. While the potential advantages and disadvantages of variable selection have been discussed in the literature for decades, few large-scale simulation studies have neutrally compared data-driven variable selection methods with respect to their consequences for the resulting models. We present the protocol for a simulation study that will evaluate different variable selection methods: forward selection, stepwise forward selection, backward elimination, augmented backward elimination, univariable selection, univariable selection followed by backward elimination, and penalized likelihood approaches (Lasso, relaxed Lasso, adaptive Lasso). These methods will be compared with respect to false inclusion and/or exclusion of variables, consequences on bias and variance of the estimated regression coefficients, the validity of the confidence intervals for the coefficients, the accuracy of the estimated variable importance ranking, and the predictive performance of the selected models. We consider both linear and logistic regression in a low-dimensional setting (20 independent variables with 10 true predictors and 10 noise variables). The simulation will be based on real-world data from the National Health and Nutrition Examination Survey (NHANES). Publishing this study protocol ahead of performing the simulation increases transparency and allows integrating the perspective of other experts into the study design.</p>
</section></details>
</section>

<section id="regression-without-regrets-initial-data-analysis-is-a-prerequisite-for-multivariable-regression" class="level2">
<h2 class="anchored" data-anchor-id="regression-without-regrets-initial-data-analysis-is-a-prerequisite-for-multivariable-regression">Regression without regrets –initial data analysis is a prerequisite for multivariable regression</h2>
<p>Heinze, G., Baillie, M., Lusa, L., Sauerbrei, W., Schmidt, C.O., Harrell, F.E., Huebner, M., on behalf of TG2 and TG3 of the STRATOS initiative, 2024. Regression without regrets –initial data analysis is a prerequisite for multivariable regression. BMC Med Res Methodol 24, 178. <a href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/s12874-024-02294-3">https://doi.org/10.1186/s12874-024-02294-3</a></p>
<details>
<summary>
Abstract
</summary>
<section id="abstract-2" class="level3">
<h3 class="anchored" data-anchor-id="abstract-2">Abstract</h3>
<p>Statistical regression models are used for predicting outcomes based on the values of some predictor variables or for describing the association of an outcome with predictors. With a data set at hand, a regression model can be easily fit with standard software packages. This bears the risk that data analysts may rush to perform sophisticated analyses without sufficient knowledge of basic properties, associations in and errors of their data, leading to wrong interpretation and presentation of the modeling results that lacks clarity. Ignorance about special features of the data such as redundancies or particular distributions may even invalidate the chosen analysis strategy. Initial data analysis (IDA) is prerequisite to regression analyses as it provides knowledge about the data needed to confirm the appropriateness of or to refine a chosen model building strategy, to interpret the modeling results correctly, and to guide the presentation of modeling results. In order to facilitate reproducibility, IDA needs to be preplanned, an IDA plan should be included in the general statistical analysis plan of a research project, and results should be well documented. Biased statistical inference of the final regression model can be minimized if IDA abstains from evaluating associations of outcome and predictors, a key principle of IDA. We give advice on which aspects to consider in an IDA plan for data screening in the context of regression modeling to supplement the statistical analysis plan. We illustrate this IDA plan for data screening in an example of a typical diagnostic modeling project and give recommendations for data visualizations.</p>
</section></details>
</section>

<section id="review-of-guidance-papers-on-regression-modeling-in-statistical-series-of-medical-journals" class="level2">
<h2 class="anchored" data-anchor-id="review-of-guidance-papers-on-regression-modeling-in-statistical-series-of-medical-journals">Review of guidance papers on regression modeling in statistical series of medical journals</h2>
<p>Wallisch, C., Bach, P., Hafermann, L., Klein, N., Sauerbrei, W., Steyerberg, E.W., Heinze, G., Rauch, G., on behalf of topic group 2 of the STRATOS initiative, 2022. Review of guidance papers on regression modeling in statistical series of medical journals. PLoS ONE 17, e0262918. <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0262918">https://doi.org/10.1371/journal.pone.0262918</a></p>
<section id="abstract-3" class="level3">
<h3 class="anchored" data-anchor-id="abstract-3">Abstract</h3>
<details>
<summary>
Abstract
</summary>
<p>Although regression models play a central role in the analysis of medical research projects, there still exist many misconceptions on various aspects of modeling leading to faulty analyses. Indeed, the rapidly developing statistical methodology and its recent advances in regression modeling do not seem to be adequately reflected in many medical publications. This problem of knowledge transfer from statistical research to application was identified by some medical journals, which have published series of statistical tutorials and (shorter) papers mainly addressing medical researchers. The aim of this review was to assess the current level of knowledge with regard to regression modeling contained in such statistical papers. We searched for target series by a request to international statistical experts. We identified 23 series including 57 topic-relevant articles. Within each article, two independent raters analyzed the content by investigating 44 predefined aspects on regression modeling. We assessed to what extent the aspects were explained and if examples, software advices, and recommendations for or against specific methods were given. Most series (21/23) included at least one article on multivariable regression. Logistic regression was the most frequently described regression type (19/23), followed by linear regression (18/23), Cox regression and survival models (12/23) and Poisson regression (3/23). Most general aspects on regression modeling, e.g.&nbsp;model assumptions, reporting and interpretation of regression results, were covered. We did not find many misconceptions or misleading recommendations, but we identified relevant gaps, in particular with respect to addressing nonlinear effects of continuous predictors, model specification and variable selection. Specific recommendations on software were rarely given. Statistical guidance should be developed for nonlinear effects, model specification and variable selection to better support medical researchers who perform or interpret regression analyses.</p>
</details>
</section>
</section>
<section id="systematic-review-of-education-and-practical-guidance-on-regression-modeling-for-medical-researchers-who-lack-a-strong-statistical-background-study-protocol" class="level2">
<h2 class="anchored" data-anchor-id="systematic-review-of-education-and-practical-guidance-on-regression-modeling-for-medical-researchers-who-lack-a-strong-statistical-background-study-protocol">Systematic review of education and practical guidance on regression modeling for medical researchers who lack a strong statistical background: Study protocol</h2>
<p>Bach, P., Wallisch, C., Klein, N., Hafermann, L., Sauerbrei, W., Steyerberg, E.W., Heinze, G., Rauch, G., for topic group 2 of the STRATOS initiative, 2020. Systematic review of education and practical guidance on regression modeling for medical researchers who lack a strong statistical background: Study protocol. PLoS ONE 15, e0241427. <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0241427">https://doi.org/10.1371/journal.pone.0241427</a></p>
<details>
<summary>
Abstract
</summary>
In the last decades, statistical methodology has developed rapidly, in particular in the field of regression modeling. Multivariable regression models are applied in almost all medical research projects. Therefore, the potential impact of statistical misconceptions within this field can be enormous Indeed, the current theoretical statistical knowledge is not always adequately transferred to the current practice in medical statistics. Some medical journals have identified this problem and published isolated statistical articles and even whole series thereof. In this systematic review, we aim to assess the current level of education on regression modeling that is provided to medical researchers via series of statistical articles published in medical journals. The present manuscript is a protocol for a systematic review that aims to assess which aspects of regression modeling are covered by statistical series published in medical journals that intend to train and guide applied medical researchers with limited statistical knowledge. Statistical paper series cannot easily be summarized and identified by common keywords in an electronic search engine like Scopus. We therefore identified series by a systematic request to statistical experts who are part or related to the STRATOS Initiative (STRengthening Analytical Thinking for Observational Studies). Within each identified article, two raters will independently check the content of the articles with respect to a predefined list of key aspects related to regression modeling. The content analysis of the topic-relevant articles will be performed using a predefined report form to assess the content as objectively as possible. Any disputes will be resolved by a third reviewer. Summary analyses will identify potential methodological gaps and misconceptions that may have an important impact on the quality of analyses in medical research. This review will thus provide a basis for future guidance papers and tutorials in the field of regression modeling which will enable medical researchers 1) to interpret publications in a correct way, 2) to perform basic statistical analyses in a correct way and 3) to identify situations when the help of a statistical expert is required.
</details>
</section>
<section id="state-of-the-art-in-selection-of-variables-and-functional-forms-in-multivariable-analysisoutstanding-issues" class="level2">
<h2 class="anchored" data-anchor-id="state-of-the-art-in-selection-of-variables-and-functional-forms-in-multivariable-analysisoutstanding-issues">State of the art in selection of variables and functional forms in multivariable analysis—outstanding issues</h2>
<p>Sauerbrei, W., Perperoglou, A., Schmid, M., Abrahamowicz, M., Becher, H., Binder, H., Dunkler, D., Harrell, F.E., Royston, P., Heinze, G., for TG2 of the STRATOS initiative, 2020. State of the art in selection of variables and functional forms in multivariable analysis—outstanding issues. Diagn Progn Res 4, 3, s41512-020-00074–3. <a href="https://diagnprognres.biomedcentral.com/articles/10.1186/s41512-020-00074-3">https://doi.org/10.1186/s41512-020-00074-3</a></p>
<details>
<summary>
Abstract
</summary>
<section id="background" class="level3">
<h3 class="anchored" data-anchor-id="background">Background</h3>
<p>How to select variables and identify functional forms for continuous variables is a key concern when creating a multivariable model. Ad hoc ‘traditional’ approaches to variable selection have been in use for at least 50 years. Similarly, methods for determining functional forms for continuous variables were first suggested many years ago. More recently, many alternative approaches to address these two challenges have been proposed, but knowledge of their properties and meaningful comparisons between them are scarce. To define a state of the art and to provide evidence-supported guidance to researchers who have only a basic level of statistical knowledge, many outstanding issues in multivariable modelling remain. Our main aims are to identify and illustrate such gaps in the literature and present them at a moderate technical level to the wide community of practitioners, researchers and students of statistics.</p>
</section>
<section id="methods" class="level3">
<h3 class="anchored" data-anchor-id="methods">Methods</h3>
<p>We briefly discuss general issues in building descriptive regression models, strategies for variable selection, different ways of choosing functional forms for continuous variables and methods for combining the selection of variables and functions. We discuss two examples, taken from the medical literature, to illustrate problems in the practice of modelling.</p>
</section>
<section id="results" class="level3">
<h3 class="anchored" data-anchor-id="results">Results</h3>
<p>Our overview revealed that there is not yet enough evidence on which to base recommendations for the selection of variables and functional forms in multivariable analysis. Such evidence may come from comparisons between alternative methods. In particular, we highlight seven important topics that require further investigation and make suggestions for the direction of further research.</p>
</section>
<section id="conclusions" class="level3">
<h3 class="anchored" data-anchor-id="conclusions">Conclusions</h3>
Selection of variables and of functional forms are important topics in multivariable analysis. To define a state of the art and to provide evidence-supported guidance to researchers who have only a basic level of statistical knowledge, further comparative research is required.
</section></details>
</section>

<section id="a-review-of-spline-function-procedures-in-r" class="level2">
<h2 class="anchored" data-anchor-id="a-review-of-spline-function-procedures-in-r">A review of spline function procedures in R</h2>
Perperoglou, A., Sauerbrei, W., Abrahamowicz, M., Schmid, M., 2019. A review of spline function procedures in R. BMC Med Res Methodol 19, 46. <a href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/s12874-019-0666-3">https://doi.org/10.1186/s12874-019-0666-3</a>
<details>
<summary>
Abstract
</summary>
<section id="background-1" class="level3">
<h3 class="anchored" data-anchor-id="background-1">Background</h3>
<p>With progress on both the theoretical and the computational fronts the use of spline modelling has become an established tool in statistical regression analysis. An important issue in spline modelling is the availability of user friendly, well documented software packages. Following the idea of the STRengthening Analytical Thinking for Observational Studies initiative to provide users with guidance documents on the application of statistical methods in observational research, the aim of this article is to provide an overview of the most widely used spline-based techniques and their implementation in R.</p>
</section>
<section id="methods-1" class="level3">
<h3 class="anchored" data-anchor-id="methods-1">Methods</h3>
<p>In this work, we focus on the R Language for Statistical Computing which has become a hugely popular statistics software. We identified a set of packages that include functions for spline modelling within a regression framework. Using simulated and real data we provide an introduction to spline modelling and an overview of the most popular spline functions.</p>
</section>
<section id="results-1" class="level3">
<h3 class="anchored" data-anchor-id="results-1">Results</h3>
<p>We present a series of simple scenarios of univariate data, where different basis functions are used to identify the correct functional form of an independent variable. Even in simple data, using routines from different packages would lead to different results.</p>
</section>
<section id="conclusions-1" class="level3">
<h3 class="anchored" data-anchor-id="conclusions-1">Conclusions</h3>
This work illustrate challenges that an analyst faces when working with data. Most differences can be attributed to the choice of hyper-parameters rather than the basis used. In fact an experienced user will know how to obtain a reasonable outcome, regardless of the type of spline used. However, many analysts do not have sufficient knowledge to use these powerful tools adequately and will need more guidance.
</section></details>
</section>

<section id="recent-activities-of-the-topic-group-on-selection-of-variables-and-functional-forms-in-multivariable-analysis-tg2" class="level2">
<h2 class="anchored" data-anchor-id="recent-activities-of-the-topic-group-on-selection-of-variables-and-functional-forms-in-multivariable-analysis-tg2">Recent activities of the Topic Group on Selection of Variables and Functional Forms in Multivariable Analysis (TG2)</h2>
<p>Georg Heinze, Aris Perperoglou, Willi Sauerbrei on behalf of STRATOS TG2</p>
<p><a href="https://www.stratos-initiative.org/sites/default/files/2021-09/IBS_BioMetric-Bulletin-Vol38-Issue2-1_4-7-8.pdf">Biometric Bulletin 2021; 38(2):7-8</a></p>
<details>
<summary>
Abstract
</summary>
This Biometric Bulletin article provides an update of the activities of TG2 by July 2021.
</details>
</section>
<section id="introducing-the-topic-group-on-selection-of-variables-and-functional-forms-in-multivariable-analysis-tg2" class="level2">
<h2 class="anchored" data-anchor-id="introducing-the-topic-group-on-selection-of-variables-and-functional-forms-in-multivariable-analysis-tg2">Introducing the Topic Group on Selection of Variables and Functional Forms in Multivariable Analysis (TG2)</h2>
<p>Aris Perperoglou, Georg Heinze, Willi Sauerbrei on behalf of STRATOS TG2</p>
<p><a href="https://www.stratos-initiative.org/sites/default/files/2021-11/STRATOS-TG2-BB-variable-selection.pdf">Biometric Bulletin 2018; 35(3):18-19</a></p>
<details>
<summary>
Abstract
</summary>
The Biometric Bulletin has recently introduced its readership to the STRATOS initiative and described the activities of the Topic Groups on Missing Data (TG1), Measurement Error (TG4) and on Initial Data Analysis (TG3). This series now continues with an introduction to TG2, dealing with selection of variables and functional forms in multivariable analysis.
</details>
</section>

<section id="further-suggested-publications" class="level1">
<h1>Further Suggested Publications</h1>
<p>Here we list a number of textbooks and papers that were not written on behalf of STRATOS-TG2. These materials are endorsed here because they fit the aim of guidance on selection of variables and functional forms in multivariable modeling.</p>
<section id="books" class="level2">
<h2 class="anchored" data-anchor-id="books">Books</h2>
<ul>
<li><p>Harrell FE. Regression Modeling Strategies: With Applications to Linear Models, Logistic Regression, and Survival Analysis. Springer: New York, 2015. <a href="https://doi.org/10.1007/978-3-319-19425-7">https://doi.org/10.1007/978-3-319-19425-7</a> <br> <em>Integrates statistical rigor with practical guidance on variable selection, model specification, and model validation across a range of regression contexts. Focuses on restricted cubic splines as tool for modeling functional forms</em>.</p></li>
<li><p>Royston P, Sauerbrei W. Multivariable model-building: a pragmatic approach to regression analysis based on fractional polynomials for modelling continuous variables. John Wiley &amp; Sons; 2008. <a href="https://www.wiley.com/en-us/Multivariable+Model+-+Building%3A+A+Pragmatic+Approach+to+Regression+Anaylsis+based+on+Fractional+Polynomials+for+Modelling+Continuous+Variables-p-9780470028421">Link</a> <br> <em>Presents a pragmatic, structured approach to multivariable model building, where emphasis is on modeling continuous variables using fractional polynomials. Focuses on interpretability and clinical relevance of statistical models</em>.</p></li>
<li><p>Wood S. Generalized Additive Models. Chapman &amp; Hall/CRC: New York, 2006. <a href="https://doi.org/10.1201/9781315370279">https://doi.org/10.1201/9781315370279</a> <br> <em>Offers an accessible yet thorough treatment of additive modeling techniques for capturing nonlinear relationships in multivariable settings</em>.</p></li>
<li><p>Miller A. Subset Selection in Regression. Taylor &amp; Francis: Boca Raton, Florida, 2002. <a href="https://doi.org/10.1201/9781420035933">https://doi.org/10.1201/9781420035933</a> <br> <em>Provides a critical examination of subset selection methods, discussing their statistical properties, limitations, and applications</em>.</p></li>
<li><p>Boer C de. A Practical Guide to Splines revised edn. Springer: New York, 2001. <a href="https://link.springer.com/book/9780387953663">Link</a> <br> <em>Covers spline-based methods in detail, offering practical advice for incorporating flexible functional forms into regression models</em>.</p></li>
<li><p>Hastie T, Tibshirani R.. Generalized Additive Models. Chapman &amp; Hall/CRC: New York, 1990. <a href="https://www.routledge.com/Generalized-Additive-Models/Hastie-Tibshirani/p/book/9780412343902">Link</a> <br> <em>Introduces foundational concepts in additive modeling, balancing statistical theory with illustrative applied examples</em>.</p></li>
</ul>
</section>
<section id="papers" class="level2">
<h2 class="anchored" data-anchor-id="papers">Papers</h2>
<ul>
<li><p>Kipruto, E., &amp; Sauerbrei, W. (2025). Evaluating Prediction Performance: A Simulation Study Comparing Penalized and Classical Variable Selection Methods in Low-Dimensional Data. Applied Sciences, 15(13), 7443. <a href="https://doi.org/10.3390/app15137443">https://doi.org/10.3390/app15137443</a> <br> <em>Highlights how the relative performance of penalized and classical selection methods depends on data conditions, guiding informed method choice</em>.</p></li>
<li><p>Sauerbrei, W., Royston, P., &amp; Kipruto, E. (2025). Multivariable Fractional Polynomial Models and Extensions. In International Encyclopedia of Statistical Science (pp.&nbsp;1609-1616). Berlin, Heidelberg: Springer. <a href="https://doi.org/10.1007/978-3-662-69359-9_397">https://doi.org/10.1007/978-3-662-69359-9_397</a> <br> <em>Summarizes fractional polynomial modeling as a structured and practical approach to functional form selection.</em></p></li>
<li><p>Kipruto, E., &amp; Sauerbrei, W. (2024). Post‐Estimation Shrinkage in Full and Selected Linear Regression Models in Low‐Dimensional Data Revisited. Biometrical Journal, 66(7), e202300368. <a href="https://doi.org/10.1002/bimj.202300368">https://doi.org/10.1002/bimj.202300368</a> <br> <em>Demonstrates how post-estimation shrinkage can reduce overfitting and bias, offering an alternative to penalized regression after variable selection</em>.</p></li>
<li><p>Lu Z, Lou W. Bayesian approaches to variable selection: a comparative study from practical perspectives. Int J Biostat 2021; <a href="https://doi.org/10.1515/ijb-2020-0130">https://doi.org/10.1515/ijb-2020-0130</a> <br> <em>Provides practical comparisons of Bayesian variable selection approaches, supporting their application in real-world data analysis</em>.</p></li>
<li><p>Heinze G, Wallisch C, Dunkler D. Variable selection – a review and recommendations for the practicing statistician. Biometrical J. 2018; 60:431–49. <a href="https://doi.org/10.1002/bimj.201700067">https://doi.org/10.1002/bimj.201700067</a> <br> <em>Offers pragmatic recommendations on variable selection methods, emphasizing model stability, validity, and transparency</em>.</p></li>
<li><p>Binder H, Sauerbrei W, Royston P. Comparison between splines and fractional polynomials for multivariable model building with continuous covariates: a simulation study with continuous response. Statistics in Medicine 2013; 32(13): 2262– 2277. <a href="https://doi.org/10.1002/sim.5639">https://doi.org/10.1002/sim.5639</a> <br> <em>Compares splines and fractional polynomials, clarifying their relative strengths for modeling continuous covariates</em>.</p></li>
<li><p>Sauerbrei W, Royston P, Binder H. Selection of important variables and determination of functional form for continuous predictors in multivariable model building. Statistics in Medicine 2007; 26: 5512– 5528. <a href="https://doi.org/10.1002/sim.3148">https://doi.org/10.1002/sim.3148</a> <br> <em>Integrates strategies for variable selection and functional form choice, presenting fractional polynomials as a coherent solution</em>.</p></li>
<li><p>Abrahamowicz M, MacKenzie TA. Joint estimation of time‐dependent and non‐linear effects of continuous covariates on survival. Statistics in Medicine 2007; 26(2): 392– 408. <a href="https://doi.org/10.1002/sim.2519">https://doi.org/10.1002/sim.2519</a> <br> <em>Illustrates how joint modeling of time-varying and nonlinear effects improves accuracy and avoids bias in survival analysis</em>.</p></li>
<li><p>Abrahamowicz M, Du Berger R, Grover SA. Flexible modeling of the effects of serum cholesterol on coronary heart disease mortality. American Journal of Epidemiology 1997; 145(8): 714– 729. <a href="https://doi.org/10.1093/aje/145.8.714">https://doi.org/10.1093/aje/145.8.714</a> <br> <em>Shows how flexible modeling of continuous exposures can reveal nonlinear risk relationships that parametric models may obscure</em>.</p></li>
<li><p>Greenland S. Avoiding power loss associated with categorization and ordinal scores in dose‐response and trend analysis. Epidemiology (Cambridge, Mass.) 1995; 6(4): 450– 454. <a href="https://doi.org/10.1097/00001648-199507000-00025">https://doi.org/10.1097/00001648-199507000-00025</a> <br> <em>Demonstrates the loss of power and information from categorizing continuous exposures, reinforcing the need for flexible functional form modeling</em>.</p></li>
<li><p>Royston P, Altman DG. Regression using fractional polynomials of continuous covariates: parsimonious parametric modelling. Applied Statistic 1994; 43(3): 429– 467. <a href="https://doi.org/10.2307/2986270">https://doi.org/10.2307/2986270</a> <br> <em>Introduces fractional polynomials as a parsimonious and interpretable alternative to categorization or high-order polynomials</em>.</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/stratostg2\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>